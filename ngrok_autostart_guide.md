# 开机自动启动设置说明

## 概述

本项目需要同时启动两个服务：
1. **ngrok** - 内网穿透服务（端口8000）
2. **internal_proxy.py** - 代理服务器（端口5000）

## 方法一：使用启动文件夹（推荐）

### 设置步骤

1. 按 `Win + R` 键，输入 `shell:startup` 并回车
2. 将项目目录中的以下两个文件复制到打开的文件夹中：
   - `start_ngrok.bat` - ngrok启动脚本
   - `start_proxy.bat` - 代理服务器启动脚本
3. 重启电脑，两个服务将自动启动

### 启动顺序

- 代理服务器会先启动（端口5000）
- ngrok会随后启动（端口8000）

## 方法二：使用任务计划程序（需要管理员权限）

### 创建代理服务器任务

1. 按 `Win + R` 键，输入 `taskschd.msc` 并回车
2. 点击右侧的"创建基本任务"
3. 输入任务名称：`StartProxy`，点击"下一步"
4. 选择"当用户登录时"，点击"下一步"
5. 选择"启动程序"，点击"下一步"
6. 点击"浏览"，选择 `start_proxy.bat` 文件
7. 点击"完成"
8. 在任务列表中找到刚创建的任务，双击打开
9. 切换到"常规"选项卡，勾选"使用最高权限运行"
10. 点击"确定"保存

### 创建Ngrok任务

重复上述步骤，创建另一个任务：
- 任务名称：`StartNgrok`
- 程序文件：`start_ngrok.bat`

## 验证设置

重启电脑后，检查两个服务是否自动启动：

### 检查代理服务器
打开命令提示符，输入：
```bash
netstat -ano | findstr :5000
```
如果看到端口5000被监听，说明代理服务器启动成功。

### 检查ngrok
打开命令提示符，输入：
```bash
tasklist | findstr ngrok
```
如果看到 ngrok.exe 进程，说明ngrok启动成功。

### 检查服务状态
打开浏览器，访问：
- http://localhost:5000 - 代理服务器
- http://localhost:8000 - 前端页面（需要先启动HTTP服务器）

## 手动启动

如果需要手动启动服务：

1. 双击运行 `start_proxy.bat` 启动代理服务器
2. 双击运行 `start_ngrok.bat` 启动ngrok

## 注意事项

- 确保Python已正确安装并配置
- 确保ngrok已正确安装并配置
- 确保端口5000和8000没有被其他程序占用
- 如果服务启动失败，请检查防火墙设置
- 代理服务器需要在ngrok之前启动，确保端口5000可用
- 建议先测试手动启动，确认无问题后再设置开机启动

## 故障排查

### 代理服务器无法启动
- 检查Python是否安装：`python --version`
- 检查端口5000是否被占用：`netstat -ano | findstr :5000`
- 查看错误日志

### Ngrok无法启动
- 检查ngrok是否安装：`ngrok version`
- 检查端口8000是否被占用：`netstat -ano | findstr :8000`
- 检查ngrok配置文件

### 服务启动但无法访问
- 检查防火墙设置
- 检查网络连接
- 检查内部API服务器地址是否正确
